DYNPRO 100.
PROCESS BEFORE OUTPUT.
        MODULE OUTPUT_100.
        MODULE LEGGI_TABELLE.
        LOOP AT IT_TABVID INTO WA_TABVID WITH CONTROL MY_DYNPRO_100.
             MODULE MOVE_TO_DUNPRO.
        ENDLOOP.
PROCESS AFTER INPUT.
        LOOP AT IT_TABVID.
             MODULE STAMPA.
        ENDLOOP.
        MODULE USER_COMMAND_0100.
       
MODULE OUTPUT_100 OUTPUT.
       SET PF_STATUS SPACE.
ENDMODULE.

MODULE LEGGI_TABELLE OUTPUT.
       PERFORM SELEZIONE_INIZIALE.
       SELECT * FROM KNA1 WHERE KUNNR IN CLIENTI AND LAND1 IN PAESI.
       PERFORM CONTROLLA_AGENTE.
         IF SY-SUBRC = 0.
            PERFORM CONTROLLA_MATERIALE.
            IF SY-SUBRC = 0.
               PERFORM CONTROLLA_COND_PAGAM.
               IF SY-SUBRC = 0.
                  PERFORM CONTROLLA_LISTINO.
                    IF SY-SUBRC = 0.
                       PERFORM CONTROLLA_DATA.
                       IF SY-SUBRC = 0.
                          MOVE-CORRESPONDING KNA1 TO WA_TABVID.
                          APPEND WA_TABVID TO IT_TABVID.
                       ENDIF.
                    ENDIF.
               ENDIF.
            ENDIF.
         ENDIF.
       ENDSELECT.
    DESCRIBLE TABLE IT_TABVID LINES MY_DYNPRO_100-LINES.
 ENDMODULE.
 
 MODULE MOVE_TO_DYNPRO OUTPUT.
        MOVE-CORRESPONDING WA_TABVID TO TABVID.
 ENDMODULE.
 
 MODULE STAMPA_INPUT.
       MOVE TABVID-MARK TO WA_TABVID.
       MOVE TABVID-NUM  TO WA_TABVID.
       MODIFY IT_TABVID FROM WA_TABVID INDEX MY_DYNPRO_100-CURRENT_LINE.
       IF TABVID-NUM > 0.
          APPEND WA_TABVID TO IT_TABVID1.
       ENDIF.
 ENDMODULE.
 
 MODULE USER_COMMAND_100 INPUT.
        CASE SY-UCOMM.
             WHEN '%PRI'.
                  CALL SCREEN 200.
        ENDCASE.
 ENDMODULE.
 
